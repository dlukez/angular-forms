!function(a,b){"use strict";function c(a){function c(){return a.$parent&&b.isFunction(a.$parent.getContext)&&a.$parent.getContext()}function d(){e={},a.form&&a.form.fields&&b.forEach(a.form.fields,function(c){e[c.name]=b.copy(c),e[c.name].value=a.model[c.name]}),e.$parent=c()}var e;a.$watch(d),a.getContext=function(){return e}}var d=["$scope",function(a){this.getRoot=function(){return a.form},c(a)}],e=b.module("dz.forms",["dz.forms.templates","dz.forms.fields"]);e.provider("dzForm",function(){this.$get=function(){var a={};return{registerField:function(b,c){a[b]=c},unregisterField:function(b){delete a[b]},getField:function(b){return a[b]?a[b]:null}}}}),e.directive("dzForm",function(){return{restrict:"E",scope:{form:"=",disabled:"&",model:"="},replace:!0,templateUrl:"form.tpl.html",controller:d,link:function(a,c,d){if(!d.model)throw new Error("Please supply a 'model' to bind to.");var e=b.element(c.find("fieldset"));a.$watch("disabled()",function(a){e.prop("disabled",a)})}}}),e.directive("dzFormField",["$interpolate","$parse",function(a,c){return{restrict:"E",scope:!0,replace:!0,require:"^dzForm",templateUrl:"field.tpl.html",link:function(d,e,f,g){function h(){var a=d.getContext();return a.$form=d.form,a.$root=g.getRoot(),a}function i(a,b){return function(){return a?a(h(),k):b}}function j(){var a=d.field.options;if(a)if(b.isArray(a)){var c=[];b.forEach(a,function(a){c.push("string"==typeof a?{value:a,label:a}:a)}),d.options=c}else if(b.isObject(a)){var e=[];b.forEach(a,function(a,b){e.push({value:b,label:a})}),d.options=e}else d.options=null}var k={"this":d.field},l={visible:!0,required:!1,disabled:!1};if(b.forEach(l,function(a,b){d.$watch(function(){return d.field[b]},function(){var e=d.field[b]&&c(d.field[b]);d[b]=i(e,a)})}),j(),d.$watch("field.options",j),d.field.value){var m=a(d.field.value,!0);if(!m)return;d.$watch(function(){return m(h(),k)},function(a){d.field.value=a})}}}}]),e.directive("dzFieldInsertInput",["$http","$compile","$templateCache","dzForm",function(a,c,d,e){return{restrict:"M",link:function(f,g){function h(){function h(a){var d=b.element(a);for(var e in f.field.properties)d.prop(e,f.field.properties[e]);c(d)(f),g.after(d),i=d}var j,k=f.field.type;i&&(i.remove(),i=null),k&&(j=e.getField(k),j&&(j.templateUrl?a.get(j.templateUrl,{cache:d}).success(h):j.template&&h(j.template)))}var i;f.$watch("field.type",function(a,b){a!==b&&h()}),f.$watch(function(){return e.getField(f.field&&f.field.type)},h,!0)}}}]);var f=b.module("dz.forms.fields",["dz.forms.fields.templates"]);f.run(["dzForm",function(a){for(var b=["checkbox","date","form","hidden","number","radio","select","text","textarea"],c=0;c<b.length;c++){var d=b[c],e="fields/"+d+".tpl.html";a.registerField(d,{templateUrl:e})}}]),f.directive("dzSubForm",function(){return{restrict:"E",scope:!0,replace:!0,templateUrl:"form.tpl.html",link:function(a,b,d){return a.form=a[d.form],a.model?(a.model[a.field.name]||(a.model[a.field.name]={}),a.model=a.model[a.field.name],void c(a)):void(a.model=null)}}}),f.directive("dzInputDate",["dateFilter",function(a){return{require:"ngModel",link:function(b,c,d,e){e.$formatters.unshift(function(){var b=e.$modelValue;return b instanceof Date||(b=new Date(b)),a(b,"yyyy-MM-dd")}),e.$parsers.unshift(function(a){return new Date(a)})}}}]),b.module("dz.forms.templates",[]).run(["$templateCache",function(a){a.put("field.tpl.html",'<div class="dz-form-field form-group" ng-show="visible()">\n  <label ng-show="field.label">{{ field.label }}</label>\n  <!-- directive: dz-field-insert-input -->\n  <span class="help-block" ng-show="field.helpText">{{ field.helpText }}</span>\n</div>'),a.put("form.tpl.html",'<form class="dz-form">\n  <h3 class="dz-form-title">{{ form.title }}</h3>\n  <p class="dz-form-description">{{ form.description }}</p>\n  <fieldset>\n    <dz-form-field field="field" ng-repeat="(name, field) in form.fields"></dz-form-field>\n  </fieldset>\n</form>')}]),b.module("dz.forms.fields.templates",[]).run(["$templateCache",function(a){a.put("fields/checkbox.tpl.html",'<input type="checkbox" ng-model="model[field.name]" />'),a.put("fields/date.tpl.html",'<input type="date" ng-model="model[field.name]" class="form-control" dz-input-date />'),a.put("fields/form.tpl.html",'<dz-sub-form form="field" class="dz-sub-form" ng-show="visible()" disabled="disabled()"></dz-sub-form>'),a.put("fields/hidden.tpl.html",'<input type="hidden" ng-model="model[field.name]" />'),a.put("fields/number.tpl.html",'<input type="number" ng-model="model[field.name]" class="form-control" ng-disabled="disabled()" ng-required="required()" />'),a.put("fields/radio.tpl.html",'<div class="radio" ng-repeat="option in options">\n  <label>\n    <input type="radio" name="{{ field.name }}" value="{{ option.value }}" ng-model="model[field.name]" ng-disabled="disabled()" />\n    {{ option.label }}\n  </label>\n</div>'),a.put("fields/select.tpl.html",'<select class="form-control" ng-model="model[field.name]" ng-options="option.value as option.label for option in options" ng-required="required()" ng-disabled="disabled()"></select>'),a.put("fields/text.tpl.html",'<input type="text" ng-model="model[field.name]" class="form-control" ng-disabled="disabled()" ng-required="required()" />'),a.put("fields/textarea.tpl.html",'<textarea class="form-control" ng-model="model[field.name]" ng-disabled="disabled()" ng-required="required()"></textarea>')}])}(window,window.angular);
//# sourceMappingURL=dz-forms.min.js.map